<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0a0e27">
    <meta name="description" content="Phoenix: Your AI Life Optimizer. Discovers hidden patterns, makes decisions, changes lives.">
    
    <!-- PWA Configuration -->
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" href="/assets/icon-192.png">
    <link rel="apple-touch-icon" href="/assets/icon-512.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <title>Phoenix - AI Life Optimizer</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="/phoenix.css">
    
    <!-- Preload Critical Assets -->
    <link rel="preload" href="/phoenix-core.js" as="script">
    <link rel="preload" href="/phoenix-orchestrator.js" as="script">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen active">
        <div class="loading-content">
            <div class="phoenix-logo-animated">
                <svg viewBox="0 0 100 100" class="logo-svg">
                    <path d="M50 10 L65 30 L85 35 L65 50 L70 70 L50 60 L30 70 L35 50 L15 35 L35 30 Z" 
                          class="phoenix-path" fill="none" stroke="url(#gradient)" stroke-width="2"/>
                    <defs>
                        <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#00f6ff;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#ff00ff;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                </svg>
            </div>
            <h1 class="loading-title">Phoenix</h1>
            <div class="loading-progress">
                <div class="loading-bar"></div>
            </div>
            <p class="loading-text">Initializing AI systems...</p>
            <div class="loading-steps">
                <div class="step" data-step="auth">Authenticating</div>
                <div class="step" data-step="data">Loading data</div>
                <div class="step" data-step="system">System setup</div>
                <div class="step" data-step="ui">Preparing interface</div>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app" class="app-container hidden">
        
        <!-- Navigation Bar -->
        <nav id="navbar" class="navbar">
            <div class="navbar-left">
                <div class="logo" data-route="dashboard">
                    <span class="logo-icon">üî•</span>
                    <span class="logo-text">Phoenix</span>
                </div>
            </div>
            
            <div class="navbar-center">
                <a href="#dashboard" class="nav-link active" data-route="dashboard">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-text">Dashboard</span>
                </a>
                <a href="#mercury" class="nav-link" data-route="mercury">
                    <span class="nav-icon">üí™</span>
                    <span class="nav-text">Mercury</span>
                </a>
                <a href="#venus" class="nav-link" data-route="venus">
                    <span class="nav-icon">üèãÔ∏è</span>
                    <span class="nav-text">Venus</span>
                </a>
                <a href="#earth" class="nav-link" data-route="earth">
                    <span class="nav-icon">üìÖ</span>
                    <span class="nav-text">Earth</span>
                </a>
                <a href="#mars" class="nav-link" data-route="mars">
                    <span class="nav-icon">üéØ</span>
                    <span class="nav-text">Mars</span>
                </a>
                <a href="#jupiter" class="nav-link" data-route="jupiter">
                    <span class="nav-icon">üí∞</span>
                    <span class="nav-text">Jupiter</span>
                </a>
                <a href="#saturn" class="nav-link" data-route="saturn">
                    <span class="nav-icon">üßò</span>
                    <span class="nav-text">Saturn</span>
                </a>
            </div>
            
            <div class="navbar-right">
                <button class="nav-button" id="voice-button" title="Voice Assistant">
                    <span class="voice-icon">üé§</span>
                </button>
                <button class="nav-button" id="notifications-button" title="Notifications">
                    <span class="notification-icon">üîî</span>
                    <span class="notification-badge hidden">0</span>
                </button>
                <div class="user-menu">
                    <button class="user-avatar" id="user-menu-button">
                        <span id="user-avatar-text">P</span>
                    </button>
                    <div class="user-dropdown hidden" id="user-dropdown">
                        <a href="#profile" class="dropdown-item">Profile</a>
                        <a href="#settings" class="dropdown-item">Settings</a>
                        <a href="#subscription" class="dropdown-item">Subscription</a>
                        <hr class="dropdown-divider">
                        <button class="dropdown-item" id="logout-button">Logout</button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Voice Interface Overlay -->
        <div id="voice-overlay" class="voice-overlay hidden">
            <div class="voice-container">
                <button class="voice-close" id="voice-close">√ó</button>
                <div class="voice-visual">
                    <div class="voice-circle"></div>
                    <div class="voice-wave"></div>
                </div>
                <h2 class="voice-title">Talk to Phoenix</h2>
                <p class="voice-status" id="voice-status">Listening...</p>
                <div class="voice-transcript" id="voice-transcript"></div>
                <div class="voice-controls">
                    <button class="voice-control-button" id="voice-start">
                        <span class="voice-control-icon">üé§</span>
                        <span>Start</span>
                    </button>
                    <button class="voice-control-button secondary" id="voice-stop">
                        <span class="voice-control-icon">‚èπÔ∏è</span>
                        <span>Stop</span>
                    </button>
                </div>
                <div class="voice-suggestions">
                    <button class="suggestion-chip" data-query="What patterns did you find today?">Pattern Check</button>
                    <button class="suggestion-chip" data-query="Show my recovery score">Recovery</button>
                    <button class="suggestion-chip" data-query="Generate quantum workout">Workout</button>
                    <button class="suggestion-chip" data-query="What should I focus on?">Today's Plan</button>
                </div>
            </div>
        </div>

        <!-- Notification Panel -->
        <div id="notification-panel" class="notification-panel hidden">
            <div class="notification-header">
                <h3>Notifications</h3>
                <button class="mark-read" id="mark-all-read">Mark all read</button>
            </div>
            <div class="notification-list" id="notification-list">
                <!-- Notifications loaded dynamically -->
            </div>
        </div>

        <!-- Main Content Area -->
        <main id="main-content" class="main-content">
            
            <!-- Dashboard View Template -->
            <div id="view-dashboard" class="view active">
                <div class="dashboard-header">
                    <h1 class="page-title">Welcome back, <span id="user-name">User</span></h1>
                    <p class="page-subtitle" id="dashboard-insight">Phoenix is analyzing your data...</p>
                </div>

                <div class="quick-stats">
                    <div class="stat-card" data-metric="recovery">
                        <div class="stat-icon">üí™</div>
                        <div class="stat-content">
                            <span class="stat-label">Recovery Score</span>
                            <span class="stat-value" id="stat-recovery">--</span>
                            <span class="stat-change" id="stat-recovery-change"></span>
                        </div>
                    </div>
                    <div class="stat-card" data-metric="patterns">
                        <div class="stat-icon">üîç</div>
                        <div class="stat-content">
                            <span class="stat-label">New Patterns</span>
                            <span class="stat-value" id="stat-patterns">--</span>
                            <span class="stat-change" id="stat-patterns-change"></span>
                        </div>
                    </div>
                    <div class="stat-card" data-metric="interventions">
                        <div class="stat-icon">üõ°Ô∏è</div>
                        <div class="stat-content">
                            <span class="stat-label">Active Guards</span>
                            <span class="stat-value" id="stat-interventions">--</span>
                            <span class="stat-change" id="stat-interventions-change"></span>
                        </div>
                    </div>
                    <div class="stat-card" data-metric="streak">
                        <div class="stat-icon">üî•</div>
                        <div class="stat-content">
                            <span class="stat-label">Day Streak</span>
                            <span class="stat-value" id="stat-streak">--</span>
                            <span class="stat-change" id="stat-streak-change"></span>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <!-- Pattern Feed -->
                    <div class="dashboard-card pattern-feed">
                        <div class="card-header">
                            <h2>üîç Pattern Discovery</h2>
                            <button class="card-action" data-action="refresh-patterns">Refresh</button>
                        </div>
                        <div class="card-content" id="pattern-feed">
                            <div class="loading-placeholder">Discovering patterns...</div>
                        </div>
                    </div>

                    <!-- Active Interventions -->
                    <div class="dashboard-card interventions">
                        <div class="card-header">
                            <h2>üõ°Ô∏è Active Protections</h2>
                            <button class="card-action" data-action="manage-interventions">Manage</button>
                        </div>
                        <div class="card-content" id="active-interventions">
                            <div class="loading-placeholder">Checking interventions...</div>
                        </div>
                    </div>

                    <!-- Today's Recommendations -->
                    <div class="dashboard-card recommendations">
                        <div class="card-header">
                            <h2>üí° Smart Recommendations</h2>
                        </div>
                        <div class="card-content" id="recommendations">
                            <div class="loading-placeholder">Generating recommendations...</div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="dashboard-card quick-actions">
                        <div class="card-header">
                            <h2>‚ö° Quick Actions</h2>
                        </div>
                        <div class="card-content">
                            <button class="action-button" data-action="generate-workout">
                                <span class="action-icon">üèãÔ∏è</span>
                                <span class="action-text">Generate Workout</span>
                            </button>
                            <button class="action-button" data-action="check-recovery">
                                <span class="action-icon">üí™</span>
                                <span class="action-text">Check Recovery</span>
                            </button>
                            <button class="action-button" data-action="optimize-calendar">
                                <span class="action-icon">üìÖ</span>
                                <span class="action-text">Optimize Calendar</span>
                            </button>
                            <button class="action-button" data-action="financial-check">
                                <span class="action-icon">üí∞</span>
                                <span class="action-text">Financial Check</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mercury View Template (Recovery & Biometrics) -->
            <div id="view-mercury" class="view planet-view">
                <div class="planet-header">
                    <h1 class="planet-title">üí™ Mercury</h1>
                    <p class="planet-subtitle">Recovery & Biometric Intelligence</p>
                </div>
                <div id="mercury-content" class="planet-content">
                    <!-- Content loaded by phoenix-planets.js -->
                </div>
            </div>

            <!-- Venus View Template (Fitness & Nutrition) -->
            <div id="view-venus" class="view planet-view">
                <div class="planet-header">
                    <h1 class="planet-title">üèãÔ∏è Venus</h1>
                    <p class="planet-subtitle">Quantum Fitness & Nutrition</p>
                </div>
                <div id="venus-content" class="planet-content">
                    <!-- Content loaded by phoenix-planets.js -->
                </div>
            </div>

            <!-- Earth View Template (Calendar & Energy) -->
            <div id="view-earth" class="view planet-view">
                <div class="planet-header">
                    <h1 class="planet-title">üìÖ Earth</h1>
                    <p class="planet-subtitle">Calendar & Energy Optimization</p>
                </div>
                <div id="earth-content" class="planet-content">
                    <!-- Content loaded by phoenix-planets.js -->
                </div>
            </div>

            <!-- Mars View Template (Goals & Progress) -->
            <div id="view-mars" class="view planet-view">
                <div class="planet-header">
                    <h1 class="planet-title">üéØ Mars</h1>
                    <p class="planet-subtitle">Goals & Progress Tracking</p>
                </div>
                <div id="mars-content" class="planet-content">
                    <!-- Content loaded by phoenix-planets.js -->
                </div>
            </div>

            <!-- Jupiter View Template (Financial Intelligence) -->
            <div id="view-jupiter" class="view planet-view">
                <div class="planet-header">
                    <h1 class="planet-title">üí∞ Jupiter</h1>
                    <p class="planet-subtitle">Financial Intelligence</p>
                </div>
                <div id="jupiter-content" class="planet-content">
                    <!-- Content loaded by phoenix-planets.js -->
                </div>
            </div>

            <!-- Saturn View Template (Life Vision) -->
            <div id="view-saturn" class="view planet-view">
                <div class="planet-header">
                    <h1 class="planet-title">üßò Saturn</h1>
                    <p class="planet-subtitle">Life Vision & Purpose</p>
                </div>
                <div id="saturn-content" class="planet-content">
                    <!-- Content loaded by phoenix-planets.js -->
                </div>
            </div>

            <!-- Profile View -->
            <div id="view-profile" class="view settings-view">
                <div class="settings-header">
                    <h1>Profile</h1>
                </div>
                <div id="profile-content" class="settings-content">
                    <!-- Content loaded dynamically -->
                </div>
            </div>

            <!-- Settings View -->
            <div id="view-settings" class="view settings-view">
                <div class="settings-header">
                    <h1>Settings</h1>
                </div>
                <div id="settings-content" class="settings-content">
                    <!-- Content loaded dynamically -->
                </div>
            </div>

            <!-- Subscription View -->
            <div id="view-subscription" class="view settings-view">
                <div class="settings-header">
                    <h1>Subscription</h1>
                </div>
                <div id="subscription-content" class="settings-content">
                    <!-- Content loaded dynamically -->
                </div>
            </div>

        </main>

        <!-- Chat/JARVIS Interface (Floating) -->
        <div id="jarvis-container" class="jarvis-container collapsed">
            <button class="jarvis-toggle" id="jarvis-toggle">
                <span class="jarvis-icon">ü§ñ</span>
                <span class="jarvis-pulse"></span>
            </button>
            <div class="jarvis-window">
                <div class="jarvis-header">
                    <h3>JARVIS</h3>
                    <button class="jarvis-minimize" id="jarvis-minimize">‚àí</button>
                </div>
                <div class="jarvis-messages" id="jarvis-messages">
                    <div class="jarvis-message system">
                        <p>Hello! I'm JARVIS, your Phoenix AI companion. How can I help optimize your life today?</p>
                    </div>
                </div>
                <div class="jarvis-input-container">
                    <input type="text" 
                           class="jarvis-input" 
                           id="jarvis-input" 
                           placeholder="Ask me anything..."
                           autocomplete="off">
                    <button class="jarvis-send" id="jarvis-send">
                        <span>‚û§</span>
                    </button>
                    <button class="jarvis-voice" id="jarvis-voice">
                        <span>üé§</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div id="toast-container" class="toast-container"></div>

    </div>

    <!-- Login/Auth Screen -->
    <div id="auth-screen" class="auth-screen hidden">
        <div class="auth-container">
            <div class="auth-logo">
                <span class="logo-icon large">üî•</span>
                <h1>Phoenix</h1>
                <p>Your AI Life Optimizer</p>
            </div>

            <!-- Login Form -->
            <div id="login-form" class="auth-form active">
                <h2>Welcome Back</h2>
                <form id="login-form-element">
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" 
                               id="login-email" 
                               name="email" 
                               required 
                               autocomplete="email"
                               placeholder="your@email.com">
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" 
                               id="login-password" 
                               name="password" 
                               required 
                               autocomplete="current-password"
                               placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    <button type="submit" class="auth-button primary" id="login-submit">
                        <span>Login</span>
                    </button>
                    <button type="button" class="auth-button secondary" id="show-register">
                        <span>Create Account</span>
                    </button>
                    <a href="#" class="auth-link" id="forgot-password">Forgot password?</a>
                </form>
            </div>

            <!-- Register Form -->
            <div id="register-form" class="auth-form">
                <h2>Create Account</h2>
                <form id="register-form-element">
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" 
                               id="register-email" 
                               name="email" 
                               required 
                               autocomplete="email"
                               placeholder="your@email.com">
                    </div>
                    <div class="form-group">
                        <label for="register-password">Password</label>
                        <input type="password" 
                               id="register-password" 
                               name="password" 
                               required 
                               autocomplete="new-password"
                               placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    <div class="form-group">
                        <label for="register-confirm">Confirm Password</label>
                        <input type="password" 
                               id="register-confirm" 
                               name="confirmPassword" 
                               required 
                               autocomplete="new-password"
                               placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    <button type="submit" class="auth-button primary" id="register-submit">
                        <span>Create Account</span>
                    </button>
                    <button type="button" class="auth-button secondary" id="show-login">
                        <span>Back to Login</span>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts in Dependency Order -->
    <script src="/src/phoenix-core.js"></script>
    <script src="/src/phoenix-orchestrator.js"></script>
    <script src="/src/phoenix-ai.js"></script>
    <script src="/src/phoenix-planets.js"></script>

    <!-- Initialization Script -->
    <script>
        // Auto-initialize on DOM ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializePhoenix);
        } else {
            initializePhoenix();
        }

        async function initializePhoenix() {
            try {
                // Phoenix Orchestrator auto-initializes
                // This is just a fallback check
                if (!window.phoenixOrchestrator) {
                    console.error('Phoenix Orchestrator failed to initialize');
                    showError('Failed to initialize Phoenix. Please refresh the page.');
                }
            } catch (error) {
                console.error('Initialization error:', error);
                showError('Initialization failed. Please refresh the page.');
            }
        }

        function showError(message) {
            const loadingScreen = document.getElementById('loading-screen');
            if (loadingScreen) {
                const loadingText = loadingScreen.querySelector('.loading-text');
                if (loadingText) {
                    loadingText.textContent = message;
                    loadingText.style.color = '#ff4444';
                }
            }
        }

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(reg => console.log('Service Worker registered:', reg))
                    .catch(err => console.log('Service Worker registration failed:', err));
            });
        }

        // Handle offline status
        window.addEventListener('online', () => {
            if (window.phoenixOrchestrator) {
                window.phoenixOrchestrator.handleOnline();
            }
        });

        window.addEventListener('offline', () => {
            if (window.phoenixOrchestrator) {
                window.phoenixOrchestrator.handleOffline();
            }
        });
    </script>

</body>
</html>
