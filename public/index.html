<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phoenix JARVIS - AI Life Operating System</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Arc Reactor Core -->
    <div id="reactor"></div>
    
    <!-- Main Interface -->
    <div id="main-interface">
        
        <!-- Header with Sync Button -->
        <div class="header">
            <h1 style="color: #00ffff; font-size: 24px;">PHOENIX JARVIS</h1>
            <button id="sync-wearables-btn" class="sync-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#00ffff">
                    <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                </svg>
                Sync Wearables
            </button>
        </div>

        <!-- Quick Input Section (NEW) -->
        <div class="quick-input-section" style="margin: 20px 0;">
            
            <!-- Quick Workout Input -->
            <div class="quick-input-box">
                <label style="color: #00ffff; font-size: 14px; margin-bottom: 5px; display: block;">
                    Quick Workout Log
                </label>
                <input 
                    type="text" 
                    id="quick-workout-input" 
                    placeholder="e.g., bench press 225x5x5"
                    class="quick-input"
                />
                <div style="color: rgba(0,255,255,0.5); font-size: 11px; margin-top: 5px;">
                    Format: exercise weight x sets x reps
                </div>
            </div>

            <!-- Quick Meal Input -->
            <div class="quick-input-box">
                <label style="color: #00ffff; font-size: 14px; margin-bottom: 5px; display: block;">
                    Quick Meal Log
                </label>
                <input 
                    type="text" 
                    id="quick-meal-input" 
                    placeholder="e.g., chicken breast 400cal 40p"
                    class="quick-input"
                />
                <div style="color: rgba(0,255,255,0.5); font-size: 11px; margin-top: 5px;">
                    Format: food name 400cal 40p
                </div>
            </div>
        </div>

        <!-- Data Display Sections -->
        <div class="data-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 20px 0;">
            
            <!-- Recent Workouts (Venus) -->
            <div class="data-panel">
                <div class="panel-header">
                    <h3>Recent Workouts</h3>
                    <button class="add-btn" onclick="openWorkoutModal()">+</button>
                </div>
                <div id="recent-workouts"></div>
            </div>

            <!-- Nutrition Summary (Venus) -->
            <div class="data-panel">
                <div class="panel-header">
                    <h3>Today's Nutrition</h3>
                    <button class="add-btn" onclick="openMealModal()">+</button>
                </div>
                <div id="nutrition-summary"></div>
            </div>

            <!-- Active Goals (Mars) -->
            <div class="data-panel">
                <div class="panel-header">
                    <h3>Active Goals</h3>
                    <button class="add-btn" onclick="openGoalModal()">+</button>
                </div>
                <div id="active-goals"></div>
            </div>
        </div>

        <!-- Chat Interface -->
        <div id="chat-interface" style="margin-top: 30px;">
            <div id="chat-messages" style="height: 200px; overflow-y: auto; background: rgba(0,0,0,0.5); padding: 15px; border: 1px solid rgba(0,255,255,0.3); margin-bottom: 10px;"></div>
            <input 
                type="text" 
                id="chat-input" 
                placeholder="Ask Phoenix anything..."
                class="quick-input"
                style="width: 100%;"
            />
        </div>
    </div>

    <!-- WORKOUT MODAL (NEW) -->
    <div id="workout-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeWorkoutModal()">&times;</span>
            <h2 style="color: #00ffff; margin-bottom: 20px;">Log Workout</h2>
            
            <form id="workout-form">
                <div class="form-group">
                    <label>Workout Name</label>
                    <input type="text" name="workout-name" required placeholder="e.g., Upper Body Push" />
                </div>

                <div class="form-group">
                    <label>Type</label>
                    <select name="workout-type">
                        <option value="strength">Strength</option>
                        <option value="cardio">Cardio</option>
                        <option value="flexibility">Flexibility</option>
                        <option value="sports">Sports</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Exercises (one per line: name, sets, reps, weight)</label>
                    <textarea name="exercises" rows="4" placeholder="Bench Press, 5, 10, 225
Overhead Press, 4, 8, 135"></textarea>
                </div>

                <div class="form-group">
                    <label>Duration (minutes)</label>
                    <input type="number" name="duration" placeholder="60" />
                </div>

                <div class="form-group">
                    <label>Mood After</label>
                    <select name="mood">
                        <option value="great">Great</option>
                        <option value="good">Good</option>
                        <option value="okay">Okay</option>
                        <option value="tired">Tired</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Notes</label>
                    <textarea name="notes" rows="2" placeholder="Optional notes..."></textarea>
                </div>

                <button type="submit" class="submit-btn">Log Workout</button>
            </form>
        </div>
    </div>

    <!-- MEAL MODAL (NEW) -->
    <div id="meal-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeMealModal()">&times;</span>
            <h2 style="color: #00ffff; margin-bottom: 20px;">Log Meal</h2>
            
            <form id="meal-form">
                <div class="form-group">
                    <label>Meal Name</label>
                    <input type="text" name="meal-name" required placeholder="e.g., Chicken & Rice" />
                </div>

                <div class="form-group">
                    <label>Meal Type</label>
                    <select name="meal-type">
                        <option value="breakfast">Breakfast</option>
                        <option value="lunch">Lunch</option>
                        <option value="dinner">Dinner</option>
                        <option value="snack">Snack</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Calories</label>
                    <input type="number" name="calories" required placeholder="500" />
                </div>

                <div class="form-group">
                    <label>Protein (g)</label>
                    <input type="number" name="protein" required placeholder="40" />
                </div>

                <div class="form-group">
                    <label>Carbs (g)</label>
                    <input type="number" name="carbs" placeholder="50" />
                </div>

                <div class="form-group">
                    <label>Fat (g)</label>
                    <input type="number" name="fat" placeholder="15" />
                </div>

                <button type="submit" class="submit-btn">Log Meal</button>
            </form>
        </div>
    </div>

    <!-- GOAL MODAL (NEW) -->
    <div id="goal-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeGoalModal()">&times;</span>
            <h2 style="color: #00ffff; margin-bottom: 20px;">Create Goal</h2>
            
            <form id="goal-form">
                <div class="form-group">
                    <label>Goal Title</label>
                    <input type="text" name="goal-title" required placeholder="e.g., Lose 10 lbs" />
                </div>

                <div class="form-group">
                    <label>Goal Type</label>
                    <select name="goal-type">
                        <option value="weight">Weight</option>
                        <option value="strength">Strength</option>
                        <option value="habit">Habit</option>
                        <option value="performance">Performance</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Target Value</label>
                    <input type="number" name="target" required placeholder="175" />
                </div>

                <div class="form-group">
                    <label>Metric</label>
                    <input type="text" name="metric" placeholder="lbs, reps, days, etc." />
                </div>

                <div class="form-group">
                    <label>Deadline</label>
                    <input type="date" name="deadline" required />
                </div>

                <button type="submit" class="submit-btn">Create Goal</button>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="api.js"></script>
    <script type="module" src="jarvis.js"></script>
    <script src="voice.js"></script>
    <script src="reactor.js"></script>

    <script>
        // Modal controls
        function openWorkoutModal() {
            document.getElementById('workout-modal').style.display = 'flex';
        }
        function closeWorkoutModal() {
            document.getElementById('workout-modal').style.display = 'none';
        }
        function openMealModal() {
            document.getElementById('meal-modal').style.display = 'flex';
        }
        function closeMealModal() {
            document.getElementById('meal-modal').style.display = 'none';
        }
        function openGoalModal() {
            document.getElementById('goal-modal').style.display = 'flex';
        }
        function closeGoalModal() {
            document.getElementById('goal-modal').style.display = 'none';
        }

        // Chat input handler
        document.getElementById('chat-input')?.addEventListener('keypress', async (e) => {
            if (e.key === 'Enter' && e.target.value.trim()) {
                const message = e.target.value.trim();
                e.target.value = '';
                
                if (window.Phoenix) {
                    window.Phoenix.addChatMessage(message, 'user');
                    
                    // Send to backend AI
                    try {
                        const response = await fetch('https://pal-backend-production.up.railway.app/api/phoenix-companion/chat', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${localStorage.getItem('phoenixToken')}`
                            },
                            body: JSON.stringify({ message })
                        });
                        
                        const data = await response.json();
                        if (data.success && data.response) {
                            window.Phoenix.addChatMessage(data.response, 'phoenix');
                            if (window.Voice) {
                                window.Voice.speak(data.response);
                            }
                        }
                    } catch (error) {
                        console.error('Chat error:', error);
                    }
                }
            }
        });
    </script>
</body>
</html>
