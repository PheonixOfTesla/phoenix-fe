<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phoenix - Initialize System</title>
    <style>
        /* ============================================
           PHOENIX ONBOARDING - HOLOGRAPHIC INTERFACE
           ============================================ */
        
        :root {
            --primary-cyan: #00ffff;
            --primary-cyan-glow: rgba(0, 255, 255, 1);
            --primary-cyan-dim: rgba(0, 255, 255, 0.6);
            --primary-cyan-border: rgba(0, 255, 255, 0.3);
            --primary-cyan-bg: rgba(0, 255, 255, 0.1);
            
            --bg-dark: #000;
            --bg-panel: rgba(0, 10, 20, 0.9);
            --bg-card: rgba(0, 10, 20, 0.8);
            
            --error-red: #ff4444;
            --success-green: #00ff88;
            
            --font-primary: 'Courier New', 'Consolas', monospace;
            
            --shadow-glow-cyan: 0 0 20px rgba(0, 255, 255, 0.4);
            --shadow-glow-cyan-strong: 0 0 30px rgba(0, 255, 255, 0.8);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-primary);
            background: var(--bg-dark);
            color: var(--primary-cyan);
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        /* Grid Underlay */
        .grid-underlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(var(--primary-cyan-border) 1px, transparent 1px),
                linear-gradient(90deg, var(--primary-cyan-border) 1px, transparent 1px);
            background-size: 50px 50px;
            opacity: 0.1;
            pointer-events: none;
            z-index: 0;
            animation: gridMove 60s linear infinite;
        }

        @keyframes gridMove {
            0% { background-position: 0 0; }
            100% { background-position: 50px 50px; }
        }

        /* VHS Overlay */
        .vhs-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 0, 0, 0.1) 2px,
                rgba(0, 0, 0, 0.1) 4px
            );
            pointer-events: none;
            z-index: 3;
            opacity: 0.3;
            animation: vhsScan 8s linear infinite;
        }

        @keyframes vhsScan {
            0% { background-position: 0 0; }
            100% { background-position: 0 100vh; }
        }

        /* Container */
        .container {
            position: relative;
            z-index: 1;
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* Progress Bar */
        .progress-wrapper {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--primary-cyan-border);
        }

        .progress-bar {
            height: 4px;
            background: linear-gradient(90deg, var(--primary-cyan), var(--primary-cyan-glow));
            transition: width 0.5s ease;
            box-shadow: 0 0 20px var(--primary-cyan-glow);
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            padding: 15px 40px;
            max-width: 900px;
            margin: 0 auto;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0.3;
            transition: opacity 0.3s;
            font-size: 11px;
            letter-spacing: 1px;
        }

        .progress-step.active {
            opacity: 1;
            color: var(--primary-cyan);
            text-shadow: 0 0 10px var(--primary-cyan-glow);
        }

        .progress-step.completed {
            opacity: 0.6;
        }

        .step-number {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 2px solid var(--primary-cyan-border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
            transition: all 0.3s;
        }

        .progress-step.active .step-number {
            border-color: var(--primary-cyan);
            background: var(--primary-cyan-bg);
            box-shadow: var(--shadow-glow-cyan);
        }

        .progress-step.completed .step-number {
            border-color: var(--primary-cyan);
            background: var(--primary-cyan);
            color: #000;
        }

        /* Phase Container */
        .phase {
            display: none;
            animation: fadeIn 0.6s ease-out;
        }

        .phase.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Phoenix Avatar */
        .phoenix-avatar {
            width: 120px;
            height: 120px;
            margin: 0 auto 30px;
            position: relative;
        }

        .avatar-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle, var(--primary-cyan-bg), transparent);
            border: 3px solid var(--primary-cyan-border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            position: relative;
            overflow: hidden;
            animation: corePulse 3s ease-in-out infinite;
        }

        @keyframes corePulse {
            0%, 100% {
                box-shadow: 0 0 30px var(--primary-cyan-glow);
            }
            50% {
                box-shadow: 0 0 50px var(--primary-cyan-glow);
            }
        }

        .avatar-circle::before {
            content: '';
            position: absolute;
            inset: -10px;
            border-radius: 50%;
            border: 2px solid var(--primary-cyan);
            opacity: 0;
        }

        .avatar-circle.speaking::before {
            animation: pulse 1.5s ease-out infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 0.8;
            }
            100% {
                transform: scale(1.4);
                opacity: 0;
            }
        }

        /* Voice Status */
        .voice-status {
            text-align: center;
            margin-bottom: 30px;
            padding: 12px;
            background: rgba(0, 255, 255, 0.03);
            border: 1px solid var(--primary-cyan-border);
            border-radius: 4px;
            font-size: 12px;
            letter-spacing: 2px;
            transition: all 0.3s;
        }

        .voice-status.speaking {
            animation: statusGlow 1.5s ease-in-out infinite;
        }

        @keyframes statusGlow {
            0%, 100% { 
                box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
                border-color: var(--primary-cyan-border);
            }
            50% { 
                box-shadow: 0 0 20px rgba(0, 255, 255, 0.6);
                border-color: var(--primary-cyan);
            }
        }

        /* Phase Header */
        .phase-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .phase-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--primary-cyan);
            text-shadow: 0 0 20px var(--primary-cyan-glow);
            letter-spacing: 2px;
        }

        .phase-subtitle {
            font-size: 14px;
            color: var(--primary-cyan-dim);
            letter-spacing: 1px;
        }

        /* Selection Grid */
        .selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .selection-card {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.05), rgba(0, 255, 255, 0.1));
            border: 1px solid var(--primary-cyan-border);
            border-radius: 4px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .selection-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .selection-card:hover {
            border-color: var(--primary-cyan);
            background: rgba(0, 255, 255, 0.15);
            transform: translateY(-4px);
            box-shadow: var(--shadow-glow-cyan-strong);
        }

        .selection-card:hover::before {
            left: 100%;
        }

        .selection-card.selected {
            border-color: var(--primary-cyan);
            background: rgba(0, 255, 255, 0.2);
            box-shadow: var(--shadow-glow-cyan);
        }

        .selection-card .icon {
            font-size: 48px;
            margin-bottom: 16px;
            text-shadow: 0 0 10px var(--primary-cyan-glow);
        }

        .selection-card .title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary-cyan);
        }

        .selection-card .subtitle {
            font-size: 12px;
            color: var(--primary-cyan-dim);
        }

        /* Voice Preview Button */
        .voice-preview-btn {
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid var(--primary-cyan-border);
            color: var(--primary-cyan);
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 12px;
            font-size: 11px;
            letter-spacing: 1px;
            font-family: var(--font-primary);
            transition: all 0.2s;
        }

        .voice-preview-btn:hover {
            background: rgba(0, 255, 255, 0.2);
            border-color: var(--primary-cyan);
            box-shadow: var(--shadow-glow-cyan);
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            color: var(--primary-cyan-dim);
            margin-bottom: 8px;
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 14px;
            background: rgba(0, 255, 255, 0.05);
            border: 1px solid var(--primary-cyan-border);
            border-radius: 4px;
            color: var(--primary-cyan);
            font-size: 14px;
            font-family: var(--font-primary);
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-cyan);
            background: rgba(0, 255, 255, 0.1);
            box-shadow: var(--shadow-glow-cyan);
        }

        /* Code Input */
        .code-input-wrapper {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin: 30px 0;
        }

        .code-digit {
            width: 60px;
            height: 70px;
            font-size: 32px;
            text-align: center;
            background: rgba(0, 255, 255, 0.05);
            border: 2px solid var(--primary-cyan-border);
            border-radius: 4px;
            color: var(--primary-cyan);
            font-weight: bold;
            font-family: var(--font-primary);
            transition: all 0.3s;
        }

        .code-digit:focus {
            outline: none;
            border-color: var(--primary-cyan);
            background: rgba(0, 255, 255, 0.1);
            box-shadow: var(--shadow-glow-cyan);
        }

        /* Buttons */
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 14px 32px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            min-width: 140px;
            font-family: var(--font-primary);
            letter-spacing: 2px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: var(--primary-cyan-border);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: var(--primary-cyan-bg);
            color: var(--primary-cyan);
            border: 2px solid var(--primary-cyan);
            box-shadow: var(--shadow-glow-cyan);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow-cyan-strong);
        }

        .btn-primary:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            color: var(--primary-cyan-dim);
            border: 1px solid var(--primary-cyan-border);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--primary-cyan);
        }

        .btn-skip {
            background: transparent;
            color: rgba(255, 255, 255, 0.4);
            border: none;
            text-decoration: underline;
        }

        /* Device Cards */
        .device-card {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.05), rgba(0, 255, 255, 0.1));
            border: 1px solid var(--primary-cyan-border);
            border-radius: 4px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .device-card:hover:not(.disabled) {
            border-color: var(--primary-cyan);
            transform: translateY(-4px);
            box-shadow: var(--shadow-glow-cyan);
        }

        .device-card.connected {
            border-color: var(--success-green);
            background: rgba(0, 255, 136, 0.1);
        }

        .device-card.disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .device-card .icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        .device-card .title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary-cyan);
        }

        .device-status {
            font-size: 11px;
            color: var(--primary-cyan-dim);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            padding: 16px 24px;
            background: var(--bg-panel);
            border: 1px solid var(--primary-cyan);
            color: var(--primary-cyan);
            border-radius: 4px;
            font-weight: 600;
            font-size: 12px;
            letter-spacing: 1px;
            z-index: 10000;
            animation: slideIn 0.3s ease-out;
            box-shadow: var(--shadow-glow-cyan);
        }

        .toast.error {
            border-color: var(--error-red);
            color: var(--error-red);
            box-shadow: 0 0 20px rgba(255, 68, 68, 0.4);
        }

        .toast.success {
            border-color: var(--success-green);
            color: var(--success-green);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.4);
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            backdrop-filter: blur(10px);
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(0, 255, 255, 0.2);
            border-top-color: var(--primary-cyan);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Intro Text */
        .intro-text {
            text-align: center;
            max-width: 600px;
            margin: 0 auto 40px;
            line-height: 1.8;
            color: var(--primary-cyan-dim);
            font-size: 14px;
        }

        .intro-text p {
            margin-bottom: 16px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .progress-steps {
                padding: 15px 20px;
                overflow-x: auto;
            }

            .progress-step {
                font-size: 10px;
            }

            .step-number {
                width: 24px;
                height: 24px;
                font-size: 10px;
            }

            .phase-title {
                font-size: 24px;
            }

            .selection-grid {
                grid-template-columns: 1fr;
            }

            .code-digit {
                width: 50px;
                height: 60px;
                font-size: 28px;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="grid-underlay"></div>
    <div class="vhs-overlay"></div>

    <!-- Progress Bar -->
    <div class="progress-wrapper">
        <div class="progress-bar" id="progressBar" style="width: 0%"></div>
        <div class="progress-steps">
            <div class="progress-step active" data-step="0">
                <div class="step-number">0</div>
                <span>INIT</span>
            </div>
            <div class="progress-step" data-step="1">
                <div class="step-number">1</div>
                <span>LANG</span>
            </div>
            <div class="progress-step" data-step="2">
                <div class="step-number">2</div>
                <span>VOICE</span>
            </div>
            <div class="progress-step" data-step="3">
                <div class="step-number">3</div>
                <span>AUTH</span>
            </div>
            <div class="progress-step" data-step="4">
                <div class="step-number">4</div>
                <span>VERIFY</span>
            </div>
            <div class="progress-step" data-step="5">
                <div class="step-number">5</div>
                <span>SYNC</span>
            </div>
            <div class="progress-step" data-step="6">
                <div class="step-number">6</div>
                <span>GOALS</span>
            </div>
            <div class="progress-step" data-step="7">
                <div class="step-number">7</div>
                <span>LAUNCH</span>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Phase 0: Welcome -->
        <div class="phase active" id="phase0">
            <div class="phoenix-avatar">
                <div class="avatar-circle" id="avatarCircle0">üî•</div>
            </div>
            <div class="voice-status" id="voiceStatus0">
                [ SYSTEM READY ]
            </div>
            <div class="phase-header">
                <h1 class="phase-title">PHOENIX INITIALIZE</h1>
                <p class="phase-subtitle">AI-POWERED LIFE OPERATING SYSTEM</p>
            </div>
            <div class="intro-text">
                <p>I'M PHOENIX, YOUR PERSONAL AI COMPANION.</p>
                <p>I'LL HELP YOU OPTIMIZE YOUR HEALTH, FITNESS, PRODUCTIVITY, AND LIFE DECISIONS.</p>
                <p>LET'S GET YOU SET UP. THIS WILL TAKE APPROXIMATELY 180 SECONDS.</p>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" onclick="startOnboarding()">[ INITIALIZE SYSTEM ]</button>
            </div>
        </div>

        <!-- Phase 1: Language Selection -->
        <div class="phase" id="phase1">
            <div class="phoenix-avatar">
                <div class="avatar-circle" id="avatarCircle1">üî•</div>
            </div>
            <div class="voice-status" id="voiceStatus1">[ VOICE ACTIVE ]</div>
            <div class="phase-header">
                <h1 class="phase-title">SELECT LANGUAGE</h1>
                <p class="phase-subtitle">CHOOSE YOUR PREFERRED LANGUAGE</p>
            </div>
            <div class="selection-grid" id="languageGrid">
                <div class="selection-card" data-lang="en" data-name="English">
                    <div class="icon">üá¨üáß</div>
                    <div class="title">ENGLISH</div>
                    <div class="subtitle">Global</div>
                </div>
                <div class="selection-card" data-lang="es" data-name="Spanish">
                    <div class="icon">üá™üá∏</div>
                    <div class="title">ESPA√ëOL</div>
                    <div class="subtitle">Spanish</div>
                </div>
                <div class="selection-card" data-lang="fr" data-name="French">
                    <div class="icon">üá´üá∑</div>
                    <div class="title">FRAN√áAIS</div>
                    <div class="subtitle">French</div>
                </div>
                <div class="selection-card" data-lang="de" data-name="German">
                    <div class="icon">üá©üá™</div>
                    <div class="title">DEUTSCH</div>
                    <div class="subtitle">German</div>
                </div>
                <div class="selection-card" data-lang="it" data-name="Italian">
                    <div class="icon">üáÆüáπ</div>
                    <div class="title">ITALIANO</div>
                    <div class="subtitle">Italian</div>
                </div>
                <div class="selection-card" data-lang="pt" data-name="Portuguese">
                    <div class="icon">üáµüáπ</div>
                    <div class="title">PORTUGU√äS</div>
                    <div class="subtitle">Portuguese</div>
                </div>
                <div class="selection-card" data-lang="nl" data-name="Dutch">
                    <div class="icon">üá≥üá±</div>
                    <div class="title">NEDERLANDS</div>
                    <div class="subtitle">Dutch</div>
                </div>
                <div class="selection-card" data-lang="pl" data-name="Polish">
                    <div class="icon">üáµüá±</div>
                    <div class="title">POLSKI</div>
                    <div class="subtitle">Polish</div>
                </div>
                <div class="selection-card" data-lang="ru" data-name="Russian">
                    <div class="icon">üá∑üá∫</div>
                    <div class="title">–†–£–°–°–ö–ò–ô</div>
                    <div class="subtitle">Russian</div>
                </div>
                <div class="selection-card" data-lang="ja" data-name="Japanese">
                    <div class="icon">üáØüáµ</div>
                    <div class="title">Êó•Êú¨Ë™û</div>
                    <div class="subtitle">Japanese</div>
                </div>
                <div class="selection-card" data-lang="zh" data-name="Chinese">
                    <div class="icon">üá®üá≥</div>
                    <div class="title">‰∏≠Êñá</div>
                    <div class="subtitle">Chinese</div>
                </div>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" id="nextPhase1" disabled>[ CONTINUE ]</button>
            </div>
        </div>

        <!-- Phase 2: Voice Selection -->
        <div class="phase" id="phase2">
            <div class="phoenix-avatar">
                <div class="avatar-circle" id="avatarCircle2">üî•</div>
            </div>
            <div class="voice-status" id="voiceStatus2">[ VOICE ACTIVE ]</div>
            <div class="phase-header">
                <h1 class="phase-title">SELECT VOICE PROFILE</h1>
                <p class="phase-subtitle">CHOOSE YOUR PREFERRED VOICE PERSONALITY</p>
            </div>
            <div class="selection-grid" id="voiceGrid">
                <div class="selection-card" data-voice="nova">
                    <div class="icon">üòä</div>
                    <div class="title">NOVA</div>
                    <div class="subtitle">Friendly Helper</div>
                    <button class="voice-preview-btn" onclick="previewVoice('nova', event)">‚ñ∂ PREVIEW</button>
                </div>
                <div class="selection-card" data-voice="echo">
                    <div class="icon">üá¨üáß</div>
                    <div class="title">ECHO</div>
                    <div class="subtitle">British Butler</div>
                    <button class="voice-preview-btn" onclick="previewVoice('echo', event)">‚ñ∂ PREVIEW</button>
                </div>
                <div class="selection-card" data-voice="onyx">
                    <div class="icon">üíº</div>
                    <div class="title">ONYX</div>
                    <div class="subtitle">Professional</div>
                    <button class="voice-preview-btn" onclick="previewVoice('onyx', event)">‚ñ∂ PREVIEW</button>
                </div>
                <div class="selection-card" data-voice="shimmer">
                    <div class="icon">üå∏</div>
                    <div class="title">SHIMMER</div>
                    <div class="subtitle">Gentle Guide</div>
                    <button class="voice-preview-btn" onclick="previewVoice('shimmer', event)">‚ñ∂ PREVIEW</button>
                </div>
                <div class="selection-card" data-voice="alloy">
                    <div class="icon">‚ö°</div>
                    <div class="title">ALLOY</div>
                    <div class="subtitle">Neutral Balanced</div>
                    <button class="voice-preview-btn" onclick="previewVoice('alloy', event)">‚ñ∂ PREVIEW</button>
                </div>
                <div class="selection-card" data-voice="fable">
                    <div class="icon">üìñ</div>
                    <div class="title">FABLE</div>
                    <div class="subtitle">Storyteller</div>
                    <button class="voice-preview-btn" onclick="previewVoice('fable', event)">‚ñ∂ PREVIEW</button>
                </div>
            </div>
            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousPhase()">[ BACK ]</button>
                <button class="btn btn-primary" id="nextPhase2" disabled>[ CONTINUE ]</button>
            </div>
        </div>

        <!-- Phase 3: Account Creation -->
        <div class="phase" id="phase3">
            <div class="phoenix-avatar">
                <div class="avatar-circle" id="avatarCircle3">üî•</div>
            </div>
            <div class="voice-status" id="voiceStatus3">[ VOICE ACTIVE ]</div>
            <div class="phase-header">
                <h1 class="phase-title">CREATE ACCOUNT</h1>
                <p class="phase-subtitle">REGISTER YOUR CREDENTIALS</p>
            </div>
            <form id="accountForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label>FULL NAME</label>
                        <input type="text" id="name" placeholder="John Doe" required>
                    </div>
                    <div class="form-group">
                        <label>PHONE NUMBER</label>
                        <input type="tel" id="phone" placeholder="+1 (555) 123-4567" required>
                    </div>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label>PASSWORD</label>
                        <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    <div class="form-group">
                        <label>CONFIRM PASSWORD</label>
                        <input type="password" id="confirmPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                </div>
            </form>
            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousPhase()">[ BACK ]</button>
                <button class="btn btn-primary" onclick="createAccount()">[ CREATE ACCOUNT ]</button>
            </div>
        </div>

        <!-- Phase 4: Phone Verification -->
        <div class="phase" id="phase4">
            <div class="phoenix-avatar">
                <div class="avatar-circle" id="avatarCircle4">üî•</div>
            </div>
            <div class="voice-status" id="voiceStatus4">[ VERIFICATION SENT ]</div>
            <div class="phase-header">
                <h1 class="phase-title">VERIFY PHONE</h1>
                <p class="phase-subtitle">ENTER 6-DIGIT CODE SENT TO <span id="userPhone" style="color: var(--primary-cyan);"></span></p>
            </div>
            <div class="code-input-wrapper">
                <input type="text" class="code-digit" maxlength="1" id="code1">
                <input type="text" class="code-digit" maxlength="1" id="code2">
                <input type="text" class="code-digit" maxlength="1" id="code3">
                <input type="text" class="code-digit" maxlength="1" id="code4">
                <input type="text" class="code-digit" maxlength="1" id="code5">
                <input type="text" class="code-digit" maxlength="1" id="code6">
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-skip" onclick="resendCode()">[ RESEND CODE ]</button>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" onclick="verifyPhone()">[ VERIFY PHONE ]</button>
            </div>
        </div>

        <!-- Phase 5: Device Connections -->
        <div class="phase" id="phase5">
            <div class="phoenix-avatar">
                <div class="avatar-circle" id="avatarCircle5">üî•</div>
            </div>
            <div class="voice-status" id="voiceStatus5">[ VOICE ACTIVE ]</div>
            <div class="phase-header">
                <h1 class="phase-title">SYNC DEVICES</h1>
                <p class="phase-subtitle">CONNECT WEARABLES FOR HEALTH TRACKING</p>
            </div>
            <div class="selection-grid">
                <div class="device-card" data-device="fitbit">
                    <div class="icon">‚åö</div>
                    <div class="title">FITBIT</div>
                    <div class="device-status">NOT CONNECTED</div>
                </div>
                <div class="device-card" data-device="polar">
                    <div class="icon">‚ù§Ô∏è</div>
                    <div class="title">POLAR</div>
                    <div class="device-status">NOT CONNECTED</div>
                </div>
                <div class="device-card disabled">
                    <div class="icon">üçé</div>
                    <div class="title">APPLE HEALTH</div>
                    <div class="device-status">COMING SOON</div>
                </div>
                <div class="device-card disabled">
                    <div class="icon">üí™</div>
                    <div class="title">WHOOP</div>
                    <div class="device-status">COMING SOON</div>
                </div>
            </div>
            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousPhase()">[ BACK ]</button>
                <button class="btn btn-primary" onclick="nextPhase()">[ CONTINUE ]</button>
                <button class="btn btn-skip" onclick="nextPhase()">[ SKIP ]</button>
            </div>
        </div>

        <!-- Phase 6: Goals Setup -->
        <div class="phase" id="phase6">
            <div class="phoenix-avatar">
                <div class="avatar-circle" id="avatarCircle6">üî•</div>
            </div>
            <div class="voice-status" id="voiceStatus6">[ VOICE ACTIVE ]</div>
            <div class="phase-header">
                <h1 class="phase-title">SET OBJECTIVES</h1>
                <p class="phase-subtitle">DEFINE YOUR PRIMARY GOALS</p>
            </div>
            <form id="goalsForm">
                <div class="form-group">
                    <label>PRIMARY OBJECTIVE</label>
                    <input type="text" id="primaryGoal" placeholder="e.g., Lose 20 pounds, Run marathon, Build muscle">
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label>CURRENT WEIGHT (LBS)</label>
                        <input type="number" id="currentWeight" placeholder="150">
                    </div>
                    <div class="form-group">
                        <label>TARGET WEIGHT (LBS)</label>
                        <input type="number" id="targetWeight" placeholder="140">
                    </div>
                </div>
            </form>
            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousPhase()">[ BACK ]</button>
                <button class="btn btn-primary" onclick="saveGoals()">[ CONTINUE ]</button>
                <button class="btn btn-skip" onclick="nextPhase()">[ SKIP ]</button>
            </div>
        </div>

        <!-- Phase 7: Complete -->
        <div class="phase" id="phase7">
            <div class="phoenix-avatar">
                <div class="avatar-circle" id="avatarCircle7">üî•</div>
            </div>
            <div class="voice-status" id="voiceStatus7">[ SYSTEM READY ]</div>
            <div class="phase-header">
                <h1 class="phase-title">INITIALIZATION COMPLETE</h1>
                <p class="phase-subtitle">WELCOME TO PHOENIX, <span id="welcomeName" style="color: var(--primary-cyan);"></span></p>
            </div>
            <div class="intro-text">
                <p>YOUR ACCOUNT IS ACTIVE.</p>
                <p>LET ME SHOW YOU AROUND YOUR NEW COMMAND CENTER.</p>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" onclick="launchApp()" style="font-size: 14px; padding: 18px 48px;">
                    [ LAUNCH PHOENIX ]
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <script>
        /**
         * PHOENIX ONBOARDING - REAL API INTEGRATION
         * 
         * This version uses the actual backend API endpoints:
         * - POST /api/auth/register - Create account
         * - POST /api/sms-verification/send-verification - Send SMS code
         * - POST /api/sms-verification/verify-code - Verify phone
         * - POST /api/sms-verification/resend-code - Resend verification
         * - POST /api/tts/generate - Text-to-speech
         * - POST /api/mercury/devices/:provider/connect - Device integration
         * - POST /api/mars/goals - Goal creation
         * 
         * Backend: https://pal-backend-production.up.railway.app
         * Frontend: https://phoenix-fe-kappa.vercel.app
         */
        
        // Configuration
        const API_BASE_URL = 'https://pal-backend-production.up.railway.app/api';
        const API_URL = 'https://pal-backend-production.up.railway.app';
        
        // API Helper Functions
        const api = {
            authToken: null,
            
            setAuthToken(token) {
                this.authToken = token;
                localStorage.setItem('phoenixToken', token);
            },
            
            async request(endpoint, options = {}) {
                const headers = {
                    'Content-Type': 'application/json',
                    ...options.headers
                };
                
                if (this.authToken) {
                    headers['Authorization'] = `Bearer ${this.authToken}`;
                }
                
                const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                    ...options,
                    headers
                });
                
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.message || `HTTP ${response.status}`);
                }
                
                return data;
            },
            
            auth: {
                async register(userData) {
                    return await api.request('/auth/register', {
                        method: 'POST',
                        body: JSON.stringify(userData)
                    });
                },
                
                async verify(data) {
                    return await api.request('/sms-verification/verify-code', {
                        method: 'POST',
                        body: JSON.stringify(data)
                    });
                },
                
                async resendVerification(data) {
                    return await api.request('/sms-verification/resend-code', {
                        method: 'POST',
                        body: JSON.stringify(data)
                    });
                }
            },
            
            mercury: {
                devices: {
                    async connect(provider) {
                        const response = await api.request(`/mercury/devices/${provider}/connect`, {
                            method: 'POST'
                        });
                        return response.connectUrl || response.url;
                    }
                }
            },
            
            mars: {
                goals: {
                    async create(goalData) {
                        return await api.request('/mars/goals', {
                            method: 'POST',
                            body: JSON.stringify(goalData)
                        });
                    }
                }
            }
        };
        
        // State
        let currentPhase = 0;
        let userData = {
            language: 'en',
            languageName: 'English',
            voice: 'echo',
            profile: {},
            authToken: null,
            devices: [],
            goals: {}
        };
        
        // Audio context for playing TTS
        let currentAudio = null;
        
        // Language code mapper for TTS API
        const languageMap = {
            'en': 'en-GB',
            'es': 'es',
            'fr': 'fr',
            'de': 'de',
            'it': 'it',
            'pt': 'pt',
            'nl': 'nl',
            'pl': 'pl',
            'ru': 'ru',
            'ja': 'ja',
            'zh': 'zh'
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            setupLanguageSelection();
            setupVoiceSelection();
            setupDeviceCards();
            setupCodeInputs();
            
            // Enable audio on first user interaction (required by browsers)
            document.body.addEventListener('click', () => {
                if (!currentAudio) {
                    console.log('[Audio] User interaction detected, audio enabled');
                }
            }, { once: true });
        });

        /**
         * Phoenix speaks using OpenAI TTS API
         */
        async function phoenixSpeak(text, phaseNum = currentPhase) {
            // Stop any current audio
            if (currentAudio) {
                currentAudio.pause();
                currentAudio = null;
            }

            // Show speaking animation
            const avatar = document.getElementById(`avatarCircle${phaseNum}`);
            const status = document.getElementById(`voiceStatus${phaseNum}`);
            if (avatar) avatar.classList.add('speaking');
            if (status) {
                status.classList.add('speaking');
                status.textContent = '[ PHOENIX SPEAKING ]';
            }

            try {
                console.log('[TTS] Requesting:', text.substring(0, 50) + '...');
                
                // Call backend TTS API
                const response = await fetch(`${API_URL}/api/tts/generate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        text: text,
                        voice: userData.voice || 'echo',
                        language: languageMap[userData.language] || 'en-GB'
                    })
                });

                console.log('[TTS] Response status:', response.status);
                console.log('[TTS] Content-Type:', response.headers.get('content-type'));

                if (!response.ok) {
                    throw new Error(`TTS failed: ${response.status}`);
                }

                // Backend returns audio/mpeg buffer directly
                const audioBlob = await response.blob();
                console.log('[TTS] Audio blob size:', audioBlob.size, 'bytes');
                
                if (audioBlob.size === 0) {
                    throw new Error('Empty audio response');
                }
                
                const audioUrl = URL.createObjectURL(audioBlob);
                console.log('[TTS] Audio URL created');

                // Play audio
                currentAudio = new Audio(audioUrl);
                
                currentAudio.onloadeddata = () => {
                    console.log('[TTS] Audio loaded, duration:', currentAudio.duration);
                };
                
                currentAudio.onerror = (e) => {
                    console.error('[TTS] Audio playback error:', e);
                    if (avatar) avatar.classList.remove('speaking');
                    if (status) {
                        status.classList.remove('speaking');
                        status.textContent = '[ VOICE STANDBY ]';
                    }
                };
                
                currentAudio.onended = () => {
                    console.log('[TTS] Audio finished playing');
                    if (avatar) avatar.classList.remove('speaking');
                    if (status) {
                        status.classList.remove('speaking');
                        status.textContent = '[ VOICE STANDBY ]';
                    }
                    URL.revokeObjectURL(audioUrl);
                };

                // Start playback
                const playPromise = currentAudio.play();
                
                if (playPromise !== undefined) {
                    playPromise
                        .then(() => {
                            console.log('[TTS] Playback started successfully');
                        })
                        .catch(error => {
                            console.error('[TTS] Playback error:', error);
                            // Browsers require user interaction for audio
                            // This is expected on first load
                            if (avatar) avatar.classList.remove('speaking');
                            if (status) {
                                status.classList.remove('speaking');
                                status.textContent = '[ VOICE STANDBY ]';
                            }
                        });
                }

            } catch (error) {
                console.error('[TTS] Error:', error);
                // Silent fail - voice is optional
                if (avatar) avatar.classList.remove('speaking');
                if (status) {
                    status.classList.remove('speaking');
                    status.textContent = '[ VOICE STANDBY ]';
                }
            }
        }


        /**
         * Start onboarding
         */
        function startOnboarding() {
            phoenixSpeak("Hello. Let's begin by selecting your language.", 0);
            setTimeout(() => nextPhase(), 2500);
        }

        /**
         * Language Selection
         */
        function setupLanguageSelection() {
            const welcomeMessages = {
                'en': 'English selected. Excellent choice.',
                'es': 'Espa√±ol seleccionado. Excelente elecci√≥n.',
                'fr': 'Fran√ßais s√©lectionn√©. Excellent choix.',
                'de': 'Deutsch ausgew√§hlt. Ausgezeichnete Wahl.',
                'it': 'Italiano selezionato. Ottima scelta.',
                'pt': 'Portugu√™s selecionado. Excelente escolha.',
                'nl': 'Nederlands geselecteerd. Uitstekende keuze.',
                'pl': 'Polski wybrany. Doskona≈Çy wyb√≥r.',
                'ru': '–†—É—Å—Å–∫–∏–π –≤—ã–±—Ä–∞–Ω. –û—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä.',
                'ja': 'Êó•Êú¨Ë™û„ÅåÈÅ∏Êäû„Åï„Çå„Åæ„Åó„Åü„ÄÇÁ¥†Êô¥„Çâ„Åó„ÅÑÈÅ∏Êäû„Åß„Åô„ÄÇ',
                'zh': 'Â∑≤ÈÄâÊã©‰∏≠Êñá„ÄÇÂæàÂ•ΩÁöÑÈÄâÊã©„ÄÇ'
            };

            const nextMessages = {
                'en': "Now, let's choose my voice. Listen to each option and select your favourite.",
                'es': 'Ahora, elijamos mi voz. Escucha cada opci√≥n y selecciona tu favorita.',
                'fr': 'Maintenant, choisissons ma voix. √âcoutez chaque option et s√©lectionnez votre pr√©f√©r√©e.',
                'de': 'Jetzt w√§hlen wir meine Stimme. H√∂ren Sie sich jede Option an und w√§hlen Sie Ihre Lieblingsstimme.',
                'it': 'Ora scegliamo la mia voce. Ascolta ogni opzione e seleziona la tua preferita.',
                'pt': 'Agora vamos escolher a minha voz. Ou√ßa cada op√ß√£o e selecione a sua favorita.',
                'nl': 'Laten we nu mijn stem kiezen. Luister naar elke optie en selecteer je favoriet.',
                'pl': 'Teraz wybierzmy m√≥j g≈Ços. Pos≈Çuchaj ka≈ºdej opcji i wybierz swojƒÖ ulubionƒÖ.',
                'ru': '–¢–µ–ø–µ—Ä—å –≤—ã–±–µ—Ä–µ–º –º–æ–π –≥–æ–ª–æ—Å. –ü–æ—Å–ª—É—à–∞–π—Ç–µ –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π –ª—é–±–∏–º—ã–π.',
                'ja': 'Ê¨°„Å´ÁßÅ„ÅÆÂ£∞„ÇíÈÅ∏„Å≥„Åæ„Åó„Çá„ÅÜ„ÄÇÂêÑ„Ç™„Éó„Ç∑„Éß„É≥„ÇíËÅû„ÅÑ„Å¶„ÄÅ„ÅäÊ∞ó„Å´ÂÖ•„Çä„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                'zh': 'Áé∞Âú®ËÆ©Êàë‰ª¨ÈÄâÊã©ÊàëÁöÑÂ£∞Èü≥„ÄÇÂê¨Âê¨ÊØè‰∏™ÈÄâÈ°πÂπ∂ÈÄâÊã©‰Ω†ÊúÄÂñúÊ¨¢ÁöÑ„ÄÇ'
            };

            document.querySelectorAll('#languageGrid .selection-card').forEach(card => {
                card.addEventListener('click', () => {
                    document.querySelectorAll('#languageGrid .selection-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    userData.language = card.dataset.lang;
                    userData.languageName = card.dataset.name;
                    document.getElementById('nextPhase1').disabled = false;
                    
                    phoenixSpeak(welcomeMessages[userData.language] || welcomeMessages['en'], 1);
                });
            });
            
            document.getElementById('nextPhase1').addEventListener('click', () => {
                phoenixSpeak(nextMessages[userData.language] || nextMessages['en'], 1);
                setTimeout(() => nextPhase(), 4000);
            });
        }

        /**
         * Voice Selection
         */
        function setupVoiceSelection() {
            const continueMessages = {
                'en': "Perfect. From now on, this is how I'll sound. Now let's create your account.",
                'es': 'Perfecto. De ahora en adelante, as√≠ es como sonar√©. Ahora creemos tu cuenta.',
                'fr': "Parfait. √Ä partir de maintenant, c'est ainsi que je sonnerai. Cr√©ons maintenant votre compte.",
                'de': 'Perfekt. Von nun an werde ich so klingen. Lassen Sie uns nun Ihr Konto erstellen.',
                'it': 'Perfetto. D\'ora in poi, suoner√≤ cos√¨. Ora creiamo il tuo account.',
                'pt': 'Perfeito. De agora em diante, √© assim que vou soar. Agora vamos criar sua conta.',
                'nl': 'Perfect. Vanaf nu klink ik zo. Laten we nu je account aanmaken.',
                'pl': 'Doskonale. Od teraz tak bƒôdƒô brzmieƒá. Teraz utw√≥rzmy twoje konto.',
                'ru': '–û—Ç–ª–∏—á–Ω–æ. –û—Ç–Ω—ã–Ω–µ —è –±—É–¥—É –∑–≤—É—á–∞—Ç—å —Ç–∞–∫. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –≤–∞—à—É —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å.',
                'ja': 'ÂÆåÁíß„Åß„Åô„ÄÇ‰ªäÂæå„ÅØ„Åì„ÅÆ„Çà„ÅÜ„Å´ËÅû„Åì„Åà„Åæ„Åô„ÄÇ„Åù„Çå„Åß„ÅØ„ÄÅ„Ç¢„Ç´„Ç¶„É≥„Éà„Çí‰ΩúÊàê„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ',
                'zh': 'ÂÆåÁæé„ÄÇ‰ªéÁé∞Âú®ÂºÄÂßãÔºåÊàë‰ºöËøôÊ†∑ËØ¥ËØù„ÄÇÁé∞Âú®ËÆ©Êàë‰ª¨ÂàõÂª∫ÊÇ®ÁöÑÂ∏êÊà∑„ÄÇ'
            };

            document.querySelectorAll('#voiceGrid .selection-card').forEach(card => {
                card.addEventListener('click', () => {
                    document.querySelectorAll('#voiceGrid .selection-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    userData.voice = card.dataset.voice;
                    document.getElementById('nextPhase2').disabled = false;
                });
            });
            
            document.getElementById('nextPhase2').addEventListener('click', () => {
                phoenixSpeak(continueMessages[userData.language] || continueMessages['en'], 2);
                setTimeout(() => nextPhase(), 4000);
            });
        }

        /**
         * Preview voice
         */
        async function previewVoice(voice, event) {
            event.stopPropagation();
            
            const samples = {
                'en': {
                    'nova': "Hello. I'm Nova, your friendly helper.",
                    'echo': "Good day. I'm Echo, your butler.",
                    'onyx': "Hello. I'm Onyx, professional assistant.",
                    'shimmer': "Hi there. I'm Shimmer, your gentle guide.",
                    'alloy': "Hello. I'm Alloy, your balanced assistant.",
                    'fable': "Greetings. I'm Fable, your storytelling companion."
                },
                'es': {
                    'nova': "Hola. Soy Nova, tu asistente amigable.",
                    'echo': "Buenos d√≠as. Soy Echo, tu mayordomo.",
                    'onyx': "Hola. Soy Onyx, asistente profesional.",
                    'shimmer': "Hola. Soy Shimmer, tu gu√≠a gentil.",
                    'alloy': "Hola. Soy Alloy, tu asistente equilibrado.",
                    'fable': "Saludos. Soy Fable, tu compa√±ero narrador."
                },
                'fr': {
                    'nova': "Bonjour. Je suis Nova, votre assistante amicale.",
                    'echo': "Bonjour. Je suis Echo, votre majordome.",
                    'onyx': "Bonjour. Je suis Onyx, assistant professionnel.",
                    'shimmer': "Bonjour. Je suis Shimmer, votre guide douce.",
                    'alloy': "Bonjour. Je suis Alloy, votre assistant √©quilibr√©.",
                    'fable': "Salutations. Je suis Fable, votre compagnon conteur."
                },
                'de': {
                    'nova': "Hallo. Ich bin Nova, deine freundliche Helferin.",
                    'echo': "Guten Tag. Ich bin Echo, dein Butler.",
                    'onyx': "Hallo. Ich bin Onyx, professioneller Assistent.",
                    'shimmer': "Hallo. Ich bin Shimmer, dein sanfter F√ºhrer.",
                    'alloy': "Hallo. Ich bin Alloy, dein ausgewogener Assistent.",
                    'fable': "Gr√º√üe. Ich bin Fable, dein Geschichtenerz√§hler."
                },
                'it': {
                    'nova': "Ciao. Sono Nova, il tuo assistente amichevole.",
                    'echo': "Buongiorno. Sono Echo, il tuo maggiordomo.",
                    'onyx': "Ciao. Sono Onyx, assistente professionale.",
                    'shimmer': "Ciao. Sono Shimmer, la tua guida gentile.",
                    'alloy': "Ciao. Sono Alloy, il tuo assistente equilibrato.",
                    'fable': "Saluti. Sono Fable, il tuo compagno narratore."
                },
                'pt': {
                    'nova': "Ol√°. Sou a Nova, sua assistente amig√°vel.",
                    'echo': "Bom dia. Sou o Echo, seu mordomo.",
                    'onyx': "Ol√°. Sou o Onyx, assistente profissional.",
                    'shimmer': "Ol√°. Sou a Shimmer, sua guia gentil.",
                    'alloy': "Ol√°. Sou o Alloy, seu assistente equilibrado.",
                    'fable': "Sauda√ß√µes. Sou o Fable, seu companheiro contador de hist√≥rias."
                },
                'nl': {
                    'nova': "Hallo. Ik ben Nova, je vriendelijke helper.",
                    'echo': "Goedendag. Ik ben Echo, je butler.",
                    'onyx': "Hallo. Ik ben Onyx, professionele assistent.",
                    'shimmer': "Hallo. Ik ben Shimmer, je zachte gids.",
                    'alloy': "Hallo. Ik ben Alloy, je evenwichtige assistent.",
                    'fable': "Groeten. Ik ben Fable, je verhalende metgezel."
                },
                'pl': {
                    'nova': "Cze≈õƒá. Jestem Nova, twoim przyjaznym pomocnikiem.",
                    'echo': "Dzie≈Ñ dobry. Jestem Echo, twoim kamerdynerem.",
                    'onyx': "Cze≈õƒá. Jestem Onyx, profesjonalnym asystentem.",
                    'shimmer': "Cze≈õƒá. Jestem Shimmer, twoim ≈Çagodnym przewodnikiem.",
                    'alloy': "Cze≈õƒá. Jestem Alloy, twoim zr√≥wnowa≈ºonym asystentem.",
                    'fable': "Pozdrowienia. Jestem Fable, twoim towarzyszem opowie≈õci."
                },
                'ru': {
                    'nova': "–ü—Ä–∏–≤–µ—Ç. –Ø –ù–æ–≤–∞, —Ç–≤–æ–π –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫.",
                    'echo': "–î–æ–±—Ä—ã–π –¥–µ–Ω—å. –Ø –≠—Ö–æ, —Ç–≤–æ–π –¥–≤–æ—Ä–µ—Ü–∫–∏–π.",
                    'onyx': "–ü—Ä–∏–≤–µ—Ç. –Ø –û–Ω–∏–∫—Å, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç.",
                    'shimmer': "–ü—Ä–∏–≤–µ—Ç. –Ø –®–∏–º–º–µ—Ä, —Ç–≤–æ–π –º—è–≥–∫–∏–π –≥–∏–¥.",
                    'alloy': "–ü—Ä–∏–≤–µ—Ç. –Ø –≠–ª–ª–æ–π, —Ç–≤–æ–π —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç.",
                    'fable': "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é. –Ø –§—ç–π–±–ª, —Ç–≤–æ–π —Ä–∞—Å—Å–∫–∞–∑—á–∏–∫."
                },
                'ja': {
                    'nova': "„Åì„Çì„Å´„Å°„ÅØ„ÄÇÁßÅ„ÅØNova„ÄÅ„ÅÇ„Å™„Åü„ÅÆË¶™„Åó„Åø„ÇÑ„Åô„ÅÑ„Éò„É´„Éë„Éº„Åß„Åô„ÄÇ",
                    'echo': "„Åì„Çì„Å´„Å°„ÅØ„ÄÇÁßÅ„ÅØEcho„ÄÅ„ÅÇ„Å™„Åü„ÅÆÂü∑‰∫ã„Åß„Åô„ÄÇ",
                    'onyx': "„Åì„Çì„Å´„Å°„ÅØ„ÄÇÁßÅ„ÅØOnyx„ÄÅ„Éó„É≠„Éï„Çß„ÉÉ„Ç∑„Éß„Éä„É´„Å™„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇ",
                    'shimmer': "„Åì„Çì„Å´„Å°„ÅØ„ÄÇÁßÅ„ÅØShimmer„ÄÅ„ÅÇ„Å™„Åü„ÅÆÂÑ™„Åó„ÅÑ„Ç¨„Ç§„Éâ„Åß„Åô„ÄÇ",
                    'alloy': "„Åì„Çì„Å´„Å°„ÅØ„ÄÇÁßÅ„ÅØAlloy„ÄÅ„ÅÇ„Å™„Åü„ÅÆ„Éê„É©„É≥„Çπ„ÅÆÂèñ„Çå„Åü„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇ",
                    'fable': "„ÅîÊå®Êã∂Áî≥„Åó‰∏ä„Åí„Åæ„Åô„ÄÇÁßÅ„ÅØFable„ÄÅ„ÅÇ„Å™„Åü„ÅÆÁâ©Ë™û„ÅÆ‰ª≤Èñì„Åß„Åô„ÄÇ"
                },
                'zh': {
                    'nova': "‰Ω†Â•Ω„ÄÇÊàëÊòØNovaÔºå‰Ω†ÂèãÂ•ΩÁöÑÂä©Êâã„ÄÇ",
                    'echo': "ÊÇ®Â•Ω„ÄÇÊàëÊòØEchoÔºåÊÇ®ÁöÑÁÆ°ÂÆ∂„ÄÇ",
                    'onyx': "‰Ω†Â•Ω„ÄÇÊàëÊòØOnyxÔºå‰∏ì‰∏öÂä©ÁêÜ„ÄÇ",
                    'shimmer': "‰Ω†Â•Ω„ÄÇÊàëÊòØShimmerÔºå‰Ω†Ê∏©ÊüîÁöÑÂêëÂØº„ÄÇ",
                    'alloy': "‰Ω†Â•Ω„ÄÇÊàëÊòØAlloyÔºå‰Ω†Âπ≥Ë°°ÁöÑÂä©Êâã„ÄÇ",
                    'fable': "ÈóÆÂÄô„ÄÇÊàëÊòØFableÔºå‰Ω†ÁöÑËÆ≤ÊïÖ‰∫ã‰ºô‰º¥„ÄÇ"
                }
            };
            
            const langSamples = samples[userData.language] || samples['en'];
            
            // Stop current audio
            if (currentAudio) {
                currentAudio.pause();
                currentAudio = null;
            }

            try {
                const response = await fetch(`${API_URL}/api/tts/generate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        text: langSamples[voice],
                        voice: voice,
                        language: userData.language
                    })
                });

                if (!response.ok) {
                    throw new Error('TTS generation failed');
                }

                const audioBlob = await response.blob();
                const audioUrl = URL.createObjectURL(audioBlob);
                currentAudio = new Audio(audioUrl);
                currentAudio.play();
                currentAudio.onended = () => {
                    URL.revokeObjectURL(audioUrl);
                    currentAudio = null;
                };

            } catch (error) {
                console.error('Preview error:', error);
                showToast('VOICE PREVIEW FAILED', 'error');
            }
        }

        /**
         * Create Account
         */
        async function createAccount() {
            const form = document.getElementById('accountForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (password !== confirmPassword) {
                showToast('PASSWORDS DO NOT MATCH', 'error');
                return;
            }

            userData.profile = {
                name: document.getElementById('name').value,
                phone: document.getElementById('phone').value,
                password: password
            };

            showLoading(true);

            try {
                // Backend requires email, so generate from phone
                const phoneDigits = userData.profile.phone.replace(/\D/g, '');
                const email = `${phoneDigits}@phoenix-temp.com`;
                
                console.log('[Registration] Submitting:', {
                    name: userData.profile.name,
                    email: email,
                    phone: userData.profile.phone,
                    language: userData.language,
                    voice: userData.voice
                });
                
                const response = await api.auth.register({
                    name: userData.profile.name,
                    email: email,
                    phone: userData.profile.phone,
                    password: userData.profile.password,
                    language: userData.language,
                    voice: userData.voice
                });

                // Extract token from response (handle different response structures)
                const token = response.token || response.data?.token;
                if (token) {
                    userData.authToken = token;
                    api.setAuthToken(token);
                    localStorage.setItem('phoenixToken', token);
                }
                
                // Send verification code - REQUIRED
                try {
                    const smsResponse = await fetch(`${API_BASE_URL}/sms-verification/send-verification`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': token ? `Bearer ${token}` : ''
                        },
                        body: JSON.stringify({
                            phone: userData.profile.phone
                        })
                    });
                    
                    if (!smsResponse.ok) {
                        const errorData = await smsResponse.json().catch(() => ({}));
                        throw new Error(errorData.error || 'Failed to send verification code');
                    }
                    
                    console.log('[SMS] Verification code sent successfully');
                } catch (verifyError) {
                    console.error('[SMS] CRITICAL: Verification send failed:', verifyError.message);
                    throw verifyError; // Re-throw to stop registration flow
                }

                showLoading(false);
                showToast('ACCOUNT CREATED SUCCESSFULLY', 'success');
                
                const verificationMessages = {
                    'en': `Great. I just sent a verification code to ${userData.profile.phone}. Can you enter it for me?`,
                    'es': `Excelente. Acabo de enviar un c√≥digo de verificaci√≥n a ${userData.profile.phone}. ¬øPuedes ingresarlo por m√≠?`,
                    'fr': `Parfait. Je viens d'envoyer un code de v√©rification au ${userData.profile.phone}. Pouvez-vous le saisir pour moi?`,
                    'de': `Gro√üartig. Ich habe gerade einen Best√§tigungscode an ${userData.profile.phone} gesendet. K√∂nnen Sie ihn f√ºr mich eingeben?`,
                    'it': `Ottimo. Ho appena inviato un codice di verifica a ${userData.profile.phone}. Puoi inserirlo per me?`,
                    'pt': `√ìtimo. Acabei de enviar um c√≥digo de verifica√ß√£o para ${userData.profile.phone}. Pode digit√°-lo para mim?`,
                    'nl': `Geweldig. Ik heb zojuist een verificatiecode naar ${userData.profile.phone} gestuurd. Kun je die voor me invoeren?`,
                    'pl': `≈öwietnie. W≈Ça≈õnie wys≈Ça≈Çem kod weryfikacyjny na ${userData.profile.phone}. Czy mo≈ºesz go dla mnie wprowadziƒá?`,
                    'ru': `–û—Ç–ª–∏—á–Ω–æ. –Ø —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏–ª –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–∞ ${userData.profile.phone}. –ú–æ–∂–µ—Ç–µ –≤–≤–µ—Å—Ç–∏ –µ–≥–æ –¥–ª—è –º–µ–Ω—è?`,
                    'ja': `Á¥†Êô¥„Çâ„Åó„ÅÑ„ÄÇ${userData.profile.phone}„Å´Á¢∫Ë™ç„Ç≥„Éº„Éâ„ÇíÈÄÅ‰ø°„Åó„Åæ„Åó„Åü„ÄÇÂÖ•Âäõ„Åó„Å¶„ÅÑ„Åü„Å†„Åë„Åæ„Åô„ÅãÔºü`,
                    'zh': `Â§™Â•Ω‰∫Ü„ÄÇÊàëÂàöÂàöÂêë${userData.profile.phone}ÂèëÈÄÅ‰∫ÜÈ™åËØÅÁ†Å„ÄÇÊÇ®ËÉΩ‰∏∫ÊàëËæìÂÖ•ÂêóÔºü`
                };
                
                phoenixSpeak(verificationMessages[userData.language] || verificationMessages['en'], 3);
                
                setTimeout(() => nextPhase(), 4000);

            } catch (error) {
                showLoading(false);
                console.error('[Registration] Error:', error);
                const errorMessage = error.message || 'Account creation failed';
                showToast(errorMessage.toUpperCase(), 'error');
            }
        }

        /**
         * Setup code inputs
         */
        function setupCodeInputs() {
            const inputs = document.querySelectorAll('.code-digit');
            inputs.forEach((input, index) => {
                input.addEventListener('input', (e) => {
                    if (e.target.value.length === 1 && index < inputs.length - 1) {
                        inputs[index + 1].focus();
                    }
                });
                
                input.addEventListener('keydown', (e) => {
                    if (e.key === 'Backspace' && !e.target.value && index > 0) {
                        inputs[index - 1].focus();
                    }
                });
            });
        }

        /**
         * Verify Email
         */
        async function verifyPhone() {
            const code = Array.from(document.querySelectorAll('.code-digit'))
                .map(input => input.value)
                .join('');

            if (code.length !== 6) {
                showToast('ENTER ALL 6 DIGITS', 'error');
                return;
            }

            showLoading(true);

            try {
                const response = await api.auth.verify({
                    phone: userData.profile.phone,
                    code: code
                });

                showLoading(false);
                showToast('PHONE VERIFIED', 'success');
                
                const verifiedMessages = {
                    'en': "Verified. Now, would you like to connect any wearable devices? This helps me track your health data and provide better insights.",
                    'es': 'Verificado. Ahora, ¬øte gustar√≠a conectar alg√∫n dispositivo port√°til? Esto me ayuda a rastrear tus datos de salud y proporcionar mejores conocimientos.',
                    'fr': 'V√©rifi√©. Maintenant, souhaitez-vous connecter des appareils portables? Cela m\'aide √† suivre vos donn√©es de sant√© et √† fournir de meilleures informations.',
                    'de': 'Verifiziert. M√∂chten Sie jetzt tragbare Ger√§te verbinden? Dies hilft mir, Ihre Gesundheitsdaten zu verfolgen und bessere Einblicke zu geben.',
                    'it': 'Verificato. Ora, vorresti connettere dispositivi indossabili? Questo mi aiuta a monitorare i tuoi dati sulla salute e fornire informazioni migliori.',
                    'pt': 'Verificado. Agora, gostaria de conectar dispositivos vest√≠veis? Isso me ajuda a rastrear seus dados de sa√∫de e fornecer melhores insights.',
                    'nl': 'Geverifieerd. Wil je nu draagbare apparaten verbinden? Dit helpt me je gezondheidsgegevens bij te houden en betere inzichten te geven.',
                    'pl': 'Zweryfikowane. Czy chcesz teraz po≈ÇƒÖczyƒá urzƒÖdzenia do noszenia? Pomaga mi to ≈õledziƒá twoje dane zdrowotne i dostarczaƒá lepsze spostrze≈ºenia.',
                    'ru': '–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ. –¢–µ–ø–µ—Ä—å —Ö–æ—Ç–∏—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –Ω–æ—Å–∏–º—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞? –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –º–Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –æ –∑–¥–æ—Ä–æ–≤—å–µ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –ª—É—á—à—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.',
                    'ja': 'Á¢∫Ë™çÊ∏à„Åø„ÄÇ„Ç¶„Çß„Ç¢„É©„Éñ„É´„Éá„Éê„Ç§„Çπ„ÇíÊé•Á∂ö„Åó„Åæ„Åô„ÅãÔºü„Åì„Çå„Å´„Çà„Çä„ÄÅÂÅ•Â∫∑„Éá„Éº„Çø„ÇíËøΩË∑°„Åó„ÄÅ„Çà„ÇäËâØ„ÅÑÊ¥ûÂØü„ÇíÊèê‰æõ„Åß„Åç„Åæ„Åô„ÄÇ',
                    'zh': 'Â∑≤È™åËØÅ„ÄÇÁé∞Âú®ÊÇ®ÊÉ≥ËøûÊé•ÂèØÁ©øÊà¥ËÆæÂ§áÂêóÔºüËøôÂèØ‰ª•Â∏ÆÂä©ÊàëËøΩË∏™ÊÇ®ÁöÑÂÅ•Â∫∑Êï∞ÊçÆÂπ∂Êèê‰æõÊõ¥Â•ΩÁöÑËßÅËß£„ÄÇ'
                };
                
                phoenixSpeak(verifiedMessages[userData.language] || verifiedMessages['en'], 4);
                
                setTimeout(() => nextPhase(), 5000);

            } catch (error) {
                showLoading(false);
                console.error('[Verification] Error:', error);
                showToast('VERIFICATION FAILED - CHECK CODE', 'error');
            }
        }

        /**
         * Resend Code
         */
        async function resendCode() {
            const resendMessages = {
                'en': "I sent a new code to your phone.",
                'es': 'Envi√© un nuevo c√≥digo a tu tel√©fono.',
                'fr': 'J\'ai envoy√© un nouveau code √† votre t√©l√©phone.',
                'de': 'Ich habe einen neuen Code an Ihr Telefon gesendet.',
                'it': 'Ho inviato un nuovo codice al tuo telefono.',
                'pt': 'Enviei um novo c√≥digo para o seu telefone.',
                'nl': 'Ik heb een nieuwe code naar je telefoon gestuurd.',
                'pl': 'Wys≈Ça≈Çem nowy kod na tw√≥j telefon.',
                'ru': '–Ø –æ—Ç–ø—Ä–∞–≤–∏–ª –Ω–æ–≤—ã–π –∫–æ–¥ –Ω–∞ –≤–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω.',
                'ja': 'Êñ∞„Åó„ÅÑ„Ç≥„Éº„Éâ„ÇíÈõªË©±„Å´ÈÄÅ‰ø°„Åó„Åæ„Åó„Åü„ÄÇ',
                'zh': 'ÊàëÂêëÊÇ®ÁöÑÊâãÊú∫ÂèëÈÄÅ‰∫ÜÊñ∞‰ª£Á†Å„ÄÇ'
            };

            try {
                await api.auth.resendVerification({ phone: userData.profile.phone });
                showToast('CODE RESENT', 'success');
                phoenixSpeak(resendMessages[userData.language] || resendMessages['en'], 4);
            } catch (error) {
                showToast('RESEND FAILED', 'error');
            }
        }

        /**
         * Device Cards Setup
         */
        function setupDeviceCards() {
            document.querySelectorAll('.device-card:not(.disabled)').forEach(card => {
                card.addEventListener('click', async () => {
                    const device = card.dataset.device;
                    
                    if (card.classList.contains('connected')) {
                        return;
                    }

                    showLoading(true);
                    
                    try {
                        const response = await api.request(`/mercury/devices/${device}/connect`, {
                            method: 'POST'
                        });
                        
                        // Get the auth URL from response
                        const authUrl = response.authUrl || response.connectUrl || response.url;
                        
                        if (!authUrl) {
                            throw new Error('No authorization URL received');
                        }
                        
                        localStorage.setItem('phoenixOnboardingData', JSON.stringify(userData));
                        window.location.href = authUrl;
                    } catch (error) {
                        showLoading(false);
                        console.error('Device connection error:', error);
                        showToast('CONNECTION FAILED', 'error');
                    }
                });
            });
        }

        /**
         * Save Goals
         */
        async function saveGoals() {
            const primaryGoal = document.getElementById('primaryGoal').value;
            const currentWeight = document.getElementById('currentWeight').value;
            const targetWeight = document.getElementById('targetWeight').value;

            if (primaryGoal && currentWeight && targetWeight) {
                userData.goals = {
                    primary: primaryGoal,
                    currentWeight: parseFloat(currentWeight),
                    targetWeight: parseFloat(targetWeight)
                };

                showLoading(true);

                try {
                    await api.mars.goals.create({
                        title: primaryGoal,
                        type: 'weight',
                        targetValue: targetWeight,
                        currentValue: currentWeight
                    });

                    showLoading(false);
                    
                    const goalMessages = {
                        'en': `Got it. ${primaryGoal} is an excellent goal. I'll help you track your progress.`,
                        'es': `Entendido. ${primaryGoal} es un objetivo excelente. Te ayudar√© a seguir tu progreso.`,
                        'fr': `Compris. ${primaryGoal} est un excellent objectif. Je vous aiderai √† suivre vos progr√®s.`,
                        'de': `Verstanden. ${primaryGoal} ist ein ausgezeichnetes Ziel. Ich helfe Ihnen, Ihren Fortschritt zu verfolgen.`,
                        'it': `Capito. ${primaryGoal} √® un obiettivo eccellente. Ti aiuter√≤ a monitorare i tuoi progressi.`,
                        'pt': `Entendido. ${primaryGoal} √© um objetivo excelente. Vou ajud√°-lo a acompanhar seu progresso.`,
                        'nl': `Begrepen. ${primaryGoal} is een uitstekend doel. Ik zal je helpen je voortgang bij te houden.`,
                        'pl': `Zrozumia≈Çem. ${primaryGoal} to doskona≈Çy cel. Pomogƒô ci ≈õledziƒá twoje postƒôpy.`,
                        'ru': `–ü–æ–Ω—è—Ç–Ω–æ. ${primaryGoal} ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è —Ü–µ–ª—å. –Ø –ø–æ–º–æ–≥—É –≤–∞–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å.`,
                        'ja': `‰∫ÜËß£„Åó„Åæ„Åó„Åü„ÄÇ${primaryGoal}„ÅØÁ¥†Êô¥„Çâ„Åó„ÅÑÁõÆÊ®ô„Åß„Åô„ÄÇÈÄ≤Êçó„ÇíËøΩË∑°„Åô„Çã„ÅäÊâã‰ºù„ÅÑ„Çí„Åó„Åæ„Åô„ÄÇ`,
                        'zh': `ÊòéÁôΩ‰∫Ü„ÄÇ${primaryGoal}ÊòØ‰∏Ä‰∏™ÂæàÂ•ΩÁöÑÁõÆÊ†á„ÄÇÊàë‰ºöÂ∏ÆÂä©ÊÇ®Ë∑üË∏™ËøõÂ∫¶„ÄÇ`
                    };
                    
                    phoenixSpeak(goalMessages[userData.language] || goalMessages['en'], 6);
                    
                } catch (error) {
                    showLoading(false);
                    console.error('Goal creation error:', error);
                }
            }

            setTimeout(() => nextPhase(), 2500);
        }

        /**
         * Launch App
         */
        function launchApp() {
            const welcomeMessages = {
                'en': "Let me show you around your new command center. Welcome aboard.",
                'es': 'D√©jame mostrarte tu nuevo centro de comando. Bienvenido a bordo.',
                'fr': 'Laissez-moi vous montrer votre nouveau centre de commandement. Bienvenue √† bord.',
                'de': 'Lassen Sie mich Ihnen Ihr neues Kommandozentrum zeigen. Willkommen an Bord.',
                'it': 'Lascia che ti mostri il tuo nuovo centro di comando. Benvenuto a bordo.',
                'pt': 'Deixe-me mostrar seu novo centro de comando. Bem-vindo a bordo.',
                'nl': 'Laat me je je nieuwe commandocentrum laten zien. Welkom aan boord.',
                'pl': 'Pozw√≥l, ≈ºe poka≈ºƒô ci twoje nowe centrum dowodzenia. Witaj na pok≈Çadzie.',
                'ru': '–ü–æ–∑–≤–æ–ª—å—Ç–µ –ø–æ–∫–∞–∑–∞—Ç—å –≤–∞–º –≤–∞—à –Ω–æ–≤—ã–π –∫–æ–º–∞–Ω–¥–Ω—ã–π —Ü–µ–Ω—Ç—Ä. –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –±–æ—Ä—Ç.',
                'ja': 'Êñ∞„Åó„ÅÑ„Ç≥„Éû„É≥„Éâ„Çª„É≥„Çø„Éº„Çí„ÅîÊ°àÂÜÖ„Åó„Åæ„Åô„ÄÇ„Çà„ÅÜ„Åì„Åù„ÄÇ',
                'zh': 'ËÆ©ÊàëÂ∏¶ÊÇ®ÂèÇËßÇÊñ∞ÁöÑÊåáÊå•‰∏≠ÂøÉ„ÄÇÊ¨¢ËøéÂä†ÂÖ•„ÄÇ'
            };

            phoenixSpeak(welcomeMessages[userData.language] || welcomeMessages['en'], 7);
            
            setTimeout(() => {
                // Redirect to main app
              localStorage.setItem('phoenixOnboardingComplete', 'true');
localStorage.setItem('phoenixLanguage', userData.language);
localStorage.setItem('phoenixVoice', userData.voice);
window.location.href = 'dashboard.html';
            }, 3000);
        }

        /**
         * Navigation
         */
        function nextPhase() {
            if (currentPhase < 7) {
                document.getElementById(`phase${currentPhase}`).classList.remove('active');
                currentPhase++;
                document.getElementById(`phase${currentPhase}`).classList.add('active');
                updateProgress();
                
                if (currentPhase === 4 && userData.profile.email) {
                    document.getElementById('userPhone').textContent = userData.profile.phone;
                }
                
                if (currentPhase === 7 && userData.profile.name) {
                    document.getElementById('welcomeName').textContent = userData.profile.name.split(' ')[0].toUpperCase();
                }
            }
        }

        function previousPhase() {
            if (currentPhase > 1) {
                document.getElementById(`phase${currentPhase}`).classList.remove('active');
                currentPhase--;
                document.getElementById(`phase${currentPhase}`).classList.add('active');
                updateProgress();
            }
        }

        function updateProgress() {
            const progress = (currentPhase / 7) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;

            document.querySelectorAll('.progress-step').forEach((step, index) => {
                if (index < currentPhase) {
                    step.classList.add('completed');
                    step.classList.remove('active');
                } else if (index === currentPhase) {
                    step.classList.add('active');
                    step.classList.remove('completed');
                } else {
                    step.classList.remove('active', 'completed');
                }
            });
        }

        /**
         * Loading State
         */
        function showLoading(show) {
            const overlay = document.getElementById('loadingOverlay');
            if (show) {
                overlay.classList.add('active');
            } else {
                overlay.classList.remove('active');
            }
        }

        /**
         * Toast Notifications
         */
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = `[ ${message} ]`;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
    </script>
</body>
</html>
